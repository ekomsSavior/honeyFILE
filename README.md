# honeyFILE 

**Defensive honeyFILE Tripwire for Linux**

`honeyFILE` is a **legal, non-harmful defensive deception tool** that plants decoy files (“honeyfiles”) in **realistic hidden locations** on your system and uses **kernel-level auditing** to alert you when someone accesses them.

---

## What honeyFILE does

* Creates **decoy files** that look valuable to an intruder
* Places them in **sneaky but believable locations** under the user’s home directory
* Uses **auditd** to log:

  * File access (read / write / execute / attribute change)
  * Timestamp
  * User / AUID
  * Process name and executable
* Correlates with **SSH authentication logs** to capture:

  * Source IP (if remote)
  * Auth method
  * Username
* Generates **forensic evidence bundles** with hashes for integrity
* Supports **randomized rotation** of decoy locations across systems

---

## Threat model

honeyFILE is designed to detect:

* Unauthorized local file browsing
* Post-compromise attacker curiosity
* SSH intrusions (password or key-based)
* Lateral movement reconnaissance
* “Living off the land” attackers poking around user data

It is **not** meant to stop the intrusion by itself — it provides **early detection and evidence**.

---

## Dependencies

```bash
sudo apt update
sudo apt install -y auditd audispd-plugins
sudo systemctl enable auditd
sudo systemctl start auditd
```
```bash
pip install psutil --break-system-packages
```
-if you dont want to run break system packages do this up in a venv and do it from there xo
---

## Install

```bash
git clone https://github.com/ekomsSavior/honeyFILE.git
cd honeyFILE
```

---

## Initialize honeyFILE

Create a decoy set in a **random hidden location**:

```bash
python3 honeyfile.py init random
```

This will:

* Choose a sneaky directory
* Create multiple decoy files
* Generate a manifest with file hashes

---

## Arm auditing (required)

```bash
sudo python3 honeyfile.py arm
```

Verify audit rules:

```bash
sudo auditctl -l | grep honeyfile
```

---

## Check status

```bash
python3 honeyfile.py status
```

This shows:

* Owner user/home
* Active decoy directory
* Files and hashes
* Whether auditd is running

---

## View recent activity

Show honeyfile access events and SSH activity from the last 60 minutes:

```bash
sudo python3 honeyfile.py report 60
```

Output includes:

* File touched
* Process used
* UID / AUID
* Timestamps
* SSH source IPs (when applicable)

---

## Export a forensic evidence bundle

```bash
sudo python3 honeyfile.py export 60
```

Creates a timestamped bundle containing:

* `audit.log` snapshot
* `auth.log` snapshot
* JSON activity report
* Manifest of decoy files
* SHA-256 hashes for integrity

 **Best practice:** copy the entire bundle to external media (USB) and keep it read-only.

---

## Rotate decoy locations

Move the honeyfiles to a **new random hidden location**:

```bash
sudo python3 honeyfile.py rotate
```

Useful for:

* Multiple laptops
* Raspberry Pis
* Long-term monitoring
* Preventing pattern recognition by attackers

---

## Decoy file themes

honeyFILE uses **safe, clearly labeled DECOY content**, such as:

* Wallet recovery phrases (fake)
* Exchange API keys (fake)
* VPN configuration backups (fake)

The files are intentionally tempting but **cause no downstream harm if copied**.

---

## Legal & ethical stance

honeyFILE follows **defensive security best practices**:

* Evidence is generated by the OS
* No interaction with attacker systems
* No retaliation or exploitation
* Suitable for IR, SOC, and LE handoff

This aligns with:

* Blue-team deception
* Honeyfiles / canary techniques
* Court-defensible logging

---

## Related projects

* [`network_ids`](https://github.com/ekomsSavior/network_ids)
  Network-level detection and response (great companion tool)

---

## Author

**ekomsSavior**
** CERTIFIED ETHICAL HACKER**
